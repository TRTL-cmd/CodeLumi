Title: Lumi Project — Daily Log
Date: 2026-01-29
Author: Automated audit / build agent

Overview
- Purpose: capture all notable repository activity, checks, audits, and next steps performed on 2026-01-29 in preparation for Phase 1 beta.
- Scope: repository build results, privacy audit findings and remediation, smoke tests, CI/workflow additions, backups handling, and outstanding action items.

Summary
- TypeScript build: completed successfully (no compile errors).
- Privacy audit: iterative runs performed. Initial run found multiple absolute Windows paths and example email addresses in training/backups. Redaction pass applied; backup artifacts moved outside repo. Final repo-surface findings reduced to historical training entries which were inspected and approved for the beta.
- Smoke self-learn test: executed and verified Ollama connectivity and write permissions for `userData` stores.
- CI: GitHub Actions workflow (`.github/workflows/prelaunch.yml`) and `npm run prelaunch:checks` added; `tests/basic_checks.js` added and validated locally.
- Artifacts archived: backup/redact backup files were moved to an external local archive (archived off-repo per privacy-first decision).

Detailed Activity Log (chronological)
1) Repository scan and component verification
- Verified presence and instantiation of core Phase 1 components: `DeepLearningAgent`, `KnowledgeProcessor`, `SignalProcessor`, `MemoryStore`, Ollama client integration, renderer UI self-learn controls.
- Confirmed file-backed persistence patterns: `training/` and `userData/` directories hold canonical KB, training logs, and memory JSON/JSONL stores.

2) Build and runtime checks
- Ran `npx tsc -p tsconfig.json` — build succeeded.
- Executed smoke script `node scripts/smoke_selflearn_test.js` — validated that a running Ollama instance is reachable (on the developer machine) and that the app can append audit/validation lines to the local JSONL stores.

3) Privacy audit and redaction
- Ran the repo privacy audit script; discovered multiple matches of the local absolute Windows path pattern and several example email addresses inside backup/training artifacts.
- Performed a redaction pass via `scripts/redact_paths.js` to replace the absolute path pattern with `[REDACTED_PATH]` across files; `.redactbak` backups were created as a safety measure.
- Moved all backups and `.redactbak` files into an external local archive (off-repo) so that the repository no longer contains the forensic backup artifacts.
- Re-ran the audit; remaining repository findings were limited to two training files. Those files were inspected and confirmed to contain only historical/example entries (user confirmed they are acceptable for the public beta).

4) CI / prelaunch automation
- Added `.github/workflows/prelaunch.yml` to run on push/PR/workflow_dispatch.
- Added `npm run prelaunch:checks` to execute a chain of checks: `npx tsc`, `node scripts/privacy_audit.js`, `node scripts/smoke_selflearn_test.js`, and `node tests/basic_checks.js`.
- Implemented `tests/basic_checks.js` to fail CI if absolute Windows paths or non-allowlisted email addresses appear in `training/lumi_knowledge.json` or `training/training.jsonl`.

5) Documentation and onboarding
- Created `docs/BETA_ONBOARDING.md` to guide testers (Ollama setup, running the app, toggling self-learn).

Privacy / Security Notes
- No repository file currently contains unredacted local absolute Windows user paths after the redaction + archive pass.
- Backups and `.redactbak` files were intentionally archived off-repo (local archive) to preserve for forensics while preventing accidental public exposure.
- Training artifacts originally flagged were inspected and determined to contain example/historical data; CI allowlist added to `tests/basic_checks.js` prevents failing on those previous known examples.

Files Created / Modified Today
- Added: `.github/workflows/prelaunch.yml` — CI job for prelaunch checks.
- Added: `tests/basic_checks.js` — basic training-file validators and email allowlist.
- Modified: `package.json` — added `prelaunch:checks` npm script.
- Added: onboarding/docs and smoke scripts (previously created earlier in the session).

Current Status (end of day)
- Build: OK
- Privacy audit (repo-surface): OK (no active absolute-path leaks in tracked repo files)
- Smoke test: OK (Ollama reachable on dev machine; writes succeed)
- CI workflow: added; local checks pass (`node tests/basic_checks.js` returned OK)

Outstanding Items / Recommendations
- Sanitize or explicitly document any historical training files intended for distribution (the team already confirmed historical examples are acceptable).
- Add lightweight unit/integration tests for `KnowledgeProcessor` and `DeepLearningAgent` to guard ingestion and redaction logic during CI.
- Implement semantic deduplication (embeddings-based) for Phase 2 acceptance criteria — currently the codebase has hooks but no finalized embedding provider.
- Consider automating backup archiving (move off-repo) as part of pre-commit/pre-push to prevent accidental reintroduction.

Next Steps (recommended immediate actions)
- Finalize whether historical training files remain in repo or should be sanitized for public beta (team decision).
- Merge CI workflow to `main` and confirm that `npm run prelaunch:checks` runs in pull-request gating.
- Add a short README describing where archival backups were moved and how to retrieve them internally (avoid exposing absolute paths in public docs).

Appendix: quick command references
Run the prelaunch checks locally:
```bash
npm ci
npm run prelaunch:checks
```

End of log.
# Daily Log — 2026-01-29

Summary:
- Added UI controls to configure session memory behavior: `sessionHistoryLimit` selector (Full / 50 / 100 / 200), default set to 50.
- Added a confirmation and warning toast when users select `Full` memory to alert about token and performance implications.
- Implemented automatic summarization of older session entries when sessions exceed a configurable threshold (`sessionSummaryThresholdEntries`, default 200).
- Added session-size warning indicator in the renderer when session character count exceeds `sessionTokenWarningChars` (default 20000).
- Implemented opt-in auto-promote-on-archive and visual promoted badges in the Curator UI.
- Updated simulator to write archives to `userData/sessions` and support `AUTO_PROMOTE=1` for testing.

Files changed (high level):
- `src/renderer.tsx` — UI controls and warnings
- `src/main.ts` — session history limits, summarization, promote-on-archive
- `test/simulate_sessions.js` — simulator writes to `userData` and supports auto-promote

Notes:
- Summarization uses the brain (`think()`) and may consume LLM/Kb resources; it is enabled by default but can be toggled off in the UI.
- Default memory limit is 50 entries to balance recall and prompt size. Full session inclusion is available but warned.

Next actions:
- Add Settings tab for advanced configuration (thresholds, summary max chars, token warning thresholds).
- Optionally add token-based accounting for precise warnings.
